title: définition du schéma des fichiers de communes avec exemple d'un tel fichier imaginaire
modified: '2020-04-09'
$schema:
  title: schéma des fichiers donnant une photo instantanée des communes
  $id: http://id.georef.eu/mvtscommunes/exfcoms/$schema
  $schema: http://json-schema.org/draft-07/schema#
  description: liste de communes, communes associées, communes déléguées et ardts m. chacun identfié par son code INSEE
  definitions:
    componentList:
      description: liste de composants d'une commune, chacun identifié par son code INSEE
      type: object
      patternProperties:
        '^\d[\dAB]\d\d\d$': # code INSEE du composant
          type: object
          required: [name]
          properties:
            name:
              description: nom du composant en typographie riche en minuscules sans article
              type: string
      additionalProperties: false
  type: object
  properties:
    title:
      type: string
    modified:
      type: string
    $schema:
      oneOf:
        - $ref: http://json-schema.org/draft-07/schema#
        - type: string
    ydADscrBhv:
      description: paramètres de comportement utilisés par le code Php de la classe AutoDescribed
      type: object
      additionalProperties: false
      properties:
        jsonLdContext:
          description: contexte JSON-LD à ajouter
          type: string
        firstLevelType:
          description: type des enregistrements de premier niveau dans contents
          type: string
        buildName:
          description: définition de l'affichage réduit par type d'objet, code Php par type défini dans definitions
          type: object
          additionalProperties:
            description: Pour chaque type le code Php d'affichage réduit est défini comme chaine
            type: string
        writePserReally:
          description: si défini alors le doc est stocké en pser
          type: boolean
    contents:
      type: object
      patternProperties:
        '^\d[\dAB]\d\d\d$': # code INSEE
          oneOf:
            - description: commune simple
              type: object
              required: [name]
              properties:
                name:
                  description: nom de la commune en typographie riche en minuscules sans article
                  type: string
                associées:
                  description: liste éventuelle des communes associées, chacune indexée par son code INSEE
                  $ref: '#/definitions/componentList'
                déléguées:
                  description: liste éventuelle des communes déléguées, chacune indexée par son code INSEE
                  $ref: '#/definitions/componentList'
                ardtMun:
                  description: liste éventuelle des arrondissements mun., chacun indexé par son code INSEE
                  $ref: '#/definitions/componentList'
              additionalProperties: false
            - description: commune associée, renvoi vers la commune de rattachement
              type: object
              required: [associéeA]
              properties:
                associéeA:
                  description: indique la commune de rattachement
                  type: [string, number]
              additionalProperties: false
            - description: commune déléguée, renvoi vers la commune de rattachement
              type: object
              required: [déléguéeDe]
              properties:
                déléguéeDe:
                  description: indique la commune de rattachement
                  type: [string, number]
              additionalProperties: false
            - description: arrondissement municipal, renvoi vers la commune de rattachement
              type: object
              required: [ardtMunDe]
              properties:
                ardtMunDe:
                  description: indique la commune de rattachement
                  type: [string, number]
              additionalProperties: false
      additionalProperties: false
    eof:
      type: 'null'
ydADscrBhv:
  jsonLdContext: http://schema.org
  firstLevelType: AdministrativeArea
  buildName: # définition de l'affichage réduit par type d'objet, code Php par type
    AdministrativeArea: |
      if (isset($item['name']))
        return "$item[name] ($skey)";
      elseif (isset($item['associéeA']))
        return "$skey associéeA $item[associéeA]";
      elseif (isset($item['déléguéeDe']))
        return "$skey déléguéeDe $item[déléguéeDe]";
  writePserReally: true
contents:
  '01001': {name: Abergement-Clémenciat}
  '01015':
    name: Arboys en Bugey
    déléguées:
      '01015': {name: Arbignieu}
      '01340': {name: Saint-Bois}
  '01245':
    name: Bohas-Meyriat-Rignat
    associées:
      '01324': {name: Rignat}
  '01324':
    associéeA: '01245'
  '01340': {déléguéeDe: '01015'}
  69123:
    name: Lyon
    ardtMun:
      69381: {name: Lyon 1er Arrondissement}
      69382: {name: Lyon 2e Arrondissement}
      69383: {name: Lyon 3e Arrondissement}
      69384: {name: Lyon 4e Arrondissement}
      69385: {name: Lyon 5e Arrondissement}
      69386: {name: Lyon 6e Arrondissement}
      69387: {name: Lyon 7e Arrondissement}
      69388: {name: Lyon 8e Arrondissement}
      69389: {name: Lyon 9e Arrondissement}
  69381: {ardtMunDe: 69123}
eof:
