title: rpigeo - structuration du rpicom comme base géo
path: /yamldoc/pub/rpicom/rpigeo
doc: |
  Réflexions sur la structuration du rpicom en base PostGIS
  
  Phase1:
    Test d'un chargement utilisant le module topology de PostGis -> loadtopo.php
    -> trop complexe, peu pertinent
  Phase2:
    Test d'un chargement dans PostGis dans une carte topologique sans le module topology
    -> schema dans rpigeo1.sql + chargement dans load.php -> possible mais nécessite d'écrire les algo. géom. en Php
  Phase3:
    Test d'une génération de la base par des requêtes PostGis
    -> rpigeo2.sql
    -> Ok sur D19 mais des erreurs difficiles à gérer une fois le chargement effectué
  Phase4:
    Mise en place de tests de pré-conditions et de corrections d'erreurs avant traitement
    -> rpigeo3.sql + schema.sql + errorcor.sql + errorcorsup.sql + exterior3.sql
    -> la méthode de correction définie dans errorcor.sql + errorcorsup.sql génère des erreurs et ne permet pas de mettre en cohérence
      géométrique entite_rattachee_carto avec commune_carto
  Phase5:
    -> ajout du process Php snap.php pour mettre les entités rattachées en cohérence topologique avec commune_carto
    abandon car trop complexe
  Phase6:
    Amélioration de la phase 4 en mettant au point une correction dans QGis
journal: |
  19-20/6/2020:
    - phase 5, écriture de snap.php
  16-18/6/2020:
    - phase 5, écriture de snap.php
  13-15/6/2020:
    - généralisation sur FRA phase 4, des erreurs
  9-13/6/2020:
    - phase 3, code ok sur D17 comrenant des e. ratt.
  6-8/6/2020:
    - mise au point phase 2
    - élaboration de la requête pour reconstruire les polygones à partir des limites
      - tester les communes constituées de plusieurs polygones
    - reste à voir
      - comment charger les entités rattachées et les précédentes années
      - comment gérer les données simplifiées, notamment en cas de simplif. topologique !
  4/6/2020:
    - tests phase 1 -> trop complexe, ST_SimplifyPreserveTopology() n'utilise pas la topologie
submodules:
sqlDBs:
  - name: rpigeo
    title: base de données Rpigeo
    doc: |
      Base associée
sqlFiles:
  - /yamldoc/pub/rpicom/rpigeo/simplify.sql
  - /yamldoc/pub/rpicom/rpigeo/rpigeo1.sql
  - /yamldoc/pub/rpicom/rpigeo/rpigeo2.sql
  - /yamldoc/pub/rpicom/rpigeo/rpigeo3.sql
  - /yamldoc/pub/rpicom/rpigeo/schema.sql
  - /yamldoc/pub/rpicom/rpigeo/errorcorr.sql
  - /yamldoc/pub/rpicom/rpigeo/errorcorsup.sql
  - /yamldoc/pub/rpicom/rpigeo/exterior.sql
phpScripts:
  - /yamldoc/pub/rpicom/rpigeo/loadtopo.php
  - /yamldoc/pub/rpicom/rpigeo/load.php
  - /yamldoc/pub/rpicom/rpigeo/snap.php
phpIncludes:
htmlFiles:
  - /yamldoc/pub/rpicom/rpigeo/rpigeo.yaml
  - /yamldoc/pub/rpicom/rpigeo/snap.yaml
