-- Pavage de rectangles englobants par grande zone géographique
drop table if exists univers;
create table univers(
  num serial,
  iso3 char(8), -- code ISO 3166-1 alpha 3 suivi pour FXX des lon et lat
  box geometry(POLYGON, 4326)
);
comment on table univers is 'Un rectangle englobant par grande zone géographique';
insert into univers(iso3, box) values
  ('FXX-6,41', ST_MakeEnvelope(-6, 41, -5, 42, 4326)),
  ('FXX-6,42', ST_MakeEnvelope(-6, 42, -5, 43, 4326)),
  ('FXX-6,43', ST_MakeEnvelope(-6, 43, -5, 44, 4326)),
  ('FXX-6,44', ST_MakeEnvelope(-6, 44, -5, 45, 4326)),
  ('FXX-6,45', ST_MakeEnvelope(-6, 45, -5, 46, 4326)),
  ('FXX-6,46', ST_MakeEnvelope(-6, 46, -5, 47, 4326)),
  ('FXX-6,47', ST_MakeEnvelope(-6, 47, -5, 48, 4326)),
  ('FXX-6,48', ST_MakeEnvelope(-6, 48, -5, 49, 4326)),
  ('FXX-6,49', ST_MakeEnvelope(-6, 49, -5, 50, 4326)),
  ('FXX-6,50', ST_MakeEnvelope(-6, 50, -5, 51, 4326)),
  ('FXX-6,51', ST_MakeEnvelope(-6, 51, -5, 52, 4326)),
  ('FXX-5,41', ST_MakeEnvelope(-5, 41, -4, 42, 4326)),
  ('FXX-5,42', ST_MakeEnvelope(-5, 42, -4, 43, 4326)),
  ('FXX-5,43', ST_MakeEnvelope(-5, 43, -4, 44, 4326)),
  ('FXX-5,44', ST_MakeEnvelope(-5, 44, -4, 45, 4326)),
  ('FXX-5,45', ST_MakeEnvelope(-5, 45, -4, 46, 4326)),
  ('FXX-5,46', ST_MakeEnvelope(-5, 46, -4, 47, 4326)),
  ('FXX-5,47', ST_MakeEnvelope(-5, 47, -4, 48, 4326)),
  ('FXX-5,48', ST_MakeEnvelope(-5, 48, -4, 49, 4326)),
  ('FXX-5,49', ST_MakeEnvelope(-5, 49, -4, 50, 4326)),
  ('FXX-5,50', ST_MakeEnvelope(-5, 50, -4, 51, 4326)),
  ('FXX-5,51', ST_MakeEnvelope(-5, 51, -4, 52, 4326)),
  ('FXX-4,41', ST_MakeEnvelope(-4, 41, -3, 42, 4326)),
  ('FXX-4,42', ST_MakeEnvelope(-4, 42, -3, 43, 4326)),
  ('FXX-4,43', ST_MakeEnvelope(-4, 43, -3, 44, 4326)),
  ('FXX-4,44', ST_MakeEnvelope(-4, 44, -3, 45, 4326)),
  ('FXX-4,45', ST_MakeEnvelope(-4, 45, -3, 46, 4326)),
  ('FXX-4,46', ST_MakeEnvelope(-4, 46, -3, 47, 4326)),
  ('FXX-4,47', ST_MakeEnvelope(-4, 47, -3, 48, 4326)),
  ('FXX-4,48', ST_MakeEnvelope(-4, 48, -3, 49, 4326)),
  ('FXX-4,49', ST_MakeEnvelope(-4, 49, -3, 50, 4326)),
  ('FXX-4,50', ST_MakeEnvelope(-4, 50, -3, 51, 4326)),
  ('FXX-4,51', ST_MakeEnvelope(-4, 51, -3, 52, 4326)),
  ('FXX-3,41', ST_MakeEnvelope(-3, 41, -2, 42, 4326)),
  ('FXX-3,42', ST_MakeEnvelope(-3, 42, -2, 43, 4326)),
  ('FXX-3,43', ST_MakeEnvelope(-3, 43, -2, 44, 4326)),
  ('FXX-3,44', ST_MakeEnvelope(-3, 44, -2, 45, 4326)),
  ('FXX-3,45', ST_MakeEnvelope(-3, 45, -2, 46, 4326)),
  ('FXX-3,46', ST_MakeEnvelope(-3, 46, -2, 47, 4326)),
  ('FXX-3,47', ST_MakeEnvelope(-3, 47, -2, 48, 4326)),
  ('FXX-3,48', ST_MakeEnvelope(-3, 48, -2, 49, 4326)),
  ('FXX-3,49', ST_MakeEnvelope(-3, 49, -2, 50, 4326)),
  ('FXX-3,50', ST_MakeEnvelope(-3, 50, -2, 51, 4326)),
  ('FXX-3,51', ST_MakeEnvelope(-3, 51, -2, 52, 4326)),
  ('FXX-2,41', ST_MakeEnvelope(-2, 41, -1, 42, 4326)),
  ('FXX-2,42', ST_MakeEnvelope(-2, 42, -1, 43, 4326)),
  ('FXX-2,43', ST_MakeEnvelope(-2, 43, -1, 44, 4326)),
  ('FXX-2,44', ST_MakeEnvelope(-2, 44, -1, 45, 4326)),
  ('FXX-2,45', ST_MakeEnvelope(-2, 45, -1, 46, 4326)),
  ('FXX-2,46', ST_MakeEnvelope(-2, 46, -1, 47, 4326)),
  ('FXX-2,47', ST_MakeEnvelope(-2, 47, -1, 48, 4326)),
  ('FXX-2,48', ST_MakeEnvelope(-2, 48, -1, 49, 4326)),
  ('FXX-2,49', ST_MakeEnvelope(-2, 49, -1, 50, 4326)),
  ('FXX-2,50', ST_MakeEnvelope(-2, 50, -1, 51, 4326)),
  ('FXX-2,51', ST_MakeEnvelope(-2, 51, -1, 52, 4326)),
  ('FXX-1,41', ST_MakeEnvelope(-1, 41, 0, 42, 4326)),
  ('FXX-1,42', ST_MakeEnvelope(-1, 42, 0, 43, 4326)),
  ('FXX-1,43', ST_MakeEnvelope(-1, 43, 0, 44, 4326)),
  ('FXX-1,44', ST_MakeEnvelope(-1, 44, 0, 45, 4326)),
  ('FXX-1,45', ST_MakeEnvelope(-1, 45, 0, 46, 4326)),
  ('FXX-1,46', ST_MakeEnvelope(-1, 46, 0, 47, 4326)),
  ('FXX-1,47', ST_MakeEnvelope(-1, 47, 0, 48, 4326)),
  ('FXX-1,48', ST_MakeEnvelope(-1, 48, 0, 49, 4326)),
  ('FXX-1,49', ST_MakeEnvelope(-1, 49, 0, 50, 4326)),
  ('FXX-1,50', ST_MakeEnvelope(-1, 50, 0, 51, 4326)),
  ('FXX-1,51', ST_MakeEnvelope(-1, 51, 0, 52, 4326)),
  ('FXX0,41', ST_MakeEnvelope(0, 41, 1, 42, 4326)),
  ('FXX0,42', ST_MakeEnvelope(0, 42, 1, 43, 4326)),
  ('FXX0,43', ST_MakeEnvelope(0, 43, 1, 44, 4326)),
  ('FXX0,44', ST_MakeEnvelope(0, 44, 1, 45, 4326)),
  ('FXX0,45', ST_MakeEnvelope(0, 45, 1, 46, 4326)),
  ('FXX0,46', ST_MakeEnvelope(0, 46, 1, 47, 4326)),
  ('FXX0,47', ST_MakeEnvelope(0, 47, 1, 48, 4326)),
  ('FXX0,48', ST_MakeEnvelope(0, 48, 1, 49, 4326)),
  ('FXX0,49', ST_MakeEnvelope(0, 49, 1, 50, 4326)),
  ('FXX0,50', ST_MakeEnvelope(0, 50, 1, 51, 4326)),
  ('FXX0,51', ST_MakeEnvelope(0, 51, 1, 52, 4326)),
  ('FXX1,41', ST_MakeEnvelope(1, 41, 2, 42, 4326)),
  ('FXX1,42', ST_MakeEnvelope(1, 42, 2, 43, 4326)),
  ('FXX1,43', ST_MakeEnvelope(1, 43, 2, 44, 4326)),
  ('FXX1,44', ST_MakeEnvelope(1, 44, 2, 45, 4326)),
  ('FXX1,45', ST_MakeEnvelope(1, 45, 2, 46, 4326)),
  ('FXX1,46', ST_MakeEnvelope(1, 46, 2, 47, 4326)),
  ('FXX1,47', ST_MakeEnvelope(1, 47, 2, 48, 4326)),
  ('FXX1,48', ST_MakeEnvelope(1, 48, 2, 49, 4326)),
  ('FXX1,49', ST_MakeEnvelope(1, 49, 2, 50, 4326)),
  ('FXX1,50', ST_MakeEnvelope(1, 50, 2, 51, 4326)),
  ('FXX1,51', ST_MakeEnvelope(1, 51, 2, 52, 4326)),
  ('FXX2,41', ST_MakeEnvelope(2, 41, 3, 42, 4326)),
  ('FXX2,42', ST_MakeEnvelope(2, 42, 3, 43, 4326)),
  ('FXX2,43', ST_MakeEnvelope(2, 43, 3, 44, 4326)),
  ('FXX2,44', ST_MakeEnvelope(2, 44, 3, 45, 4326)),
  ('FXX2,45', ST_MakeEnvelope(2, 45, 3, 46, 4326)),
  ('FXX2,46', ST_MakeEnvelope(2, 46, 3, 47, 4326)),
  ('FXX2,47', ST_MakeEnvelope(2, 47, 3, 48, 4326)),
  ('FXX2,48', ST_MakeEnvelope(2, 48, 3, 49, 4326)),
  ('FXX2,49', ST_MakeEnvelope(2, 49, 3, 50, 4326)),
  ('FXX2,50', ST_MakeEnvelope(2, 50, 3, 51, 4326)),
  ('FXX2,51', ST_MakeEnvelope(2, 51, 3, 52, 4326)),
  ('FXX3,41', ST_MakeEnvelope(3, 41, 4, 42, 4326)),
  ('FXX3,42', ST_MakeEnvelope(3, 42, 4, 43, 4326)),
  ('FXX3,43', ST_MakeEnvelope(3, 43, 4, 44, 4326)),
  ('FXX3,44', ST_MakeEnvelope(3, 44, 4, 45, 4326)),
  ('FXX3,45', ST_MakeEnvelope(3, 45, 4, 46, 4326)),
  ('FXX3,46', ST_MakeEnvelope(3, 46, 4, 47, 4326)),
  ('FXX3,47', ST_MakeEnvelope(3, 47, 4, 48, 4326)),
  ('FXX3,48', ST_MakeEnvelope(3, 48, 4, 49, 4326)),
  ('FXX3,49', ST_MakeEnvelope(3, 49, 4, 50, 4326)),
  ('FXX3,50', ST_MakeEnvelope(3, 50, 4, 51, 4326)),
  ('FXX3,51', ST_MakeEnvelope(3, 51, 4, 52, 4326)),
  ('FXX4,41', ST_MakeEnvelope(4, 41, 5, 42, 4326)),
  ('FXX4,42', ST_MakeEnvelope(4, 42, 5, 43, 4326)),
  ('FXX4,43', ST_MakeEnvelope(4, 43, 5, 44, 4326)),
  ('FXX4,44', ST_MakeEnvelope(4, 44, 5, 45, 4326)),
  ('FXX4,45', ST_MakeEnvelope(4, 45, 5, 46, 4326)),
  ('FXX4,46', ST_MakeEnvelope(4, 46, 5, 47, 4326)),
  ('FXX4,47', ST_MakeEnvelope(4, 47, 5, 48, 4326)),
  ('FXX4,48', ST_MakeEnvelope(4, 48, 5, 49, 4326)),
  ('FXX4,49', ST_MakeEnvelope(4, 49, 5, 50, 4326)),
  ('FXX4,50', ST_MakeEnvelope(4, 50, 5, 51, 4326)),
  ('FXX4,51', ST_MakeEnvelope(4, 51, 5, 52, 4326)),
  ('FXX5,41', ST_MakeEnvelope(5, 41, 6, 42, 4326)),
  ('FXX5,42', ST_MakeEnvelope(5, 42, 6, 43, 4326)),
  ('FXX5,43', ST_MakeEnvelope(5, 43, 6, 44, 4326)),
  ('FXX5,44', ST_MakeEnvelope(5, 44, 6, 45, 4326)),
  ('FXX5,45', ST_MakeEnvelope(5, 45, 6, 46, 4326)),
  ('FXX5,46', ST_MakeEnvelope(5, 46, 6, 47, 4326)),
  ('FXX5,47', ST_MakeEnvelope(5, 47, 6, 48, 4326)),
  ('FXX5,48', ST_MakeEnvelope(5, 48, 6, 49, 4326)),
  ('FXX5,49', ST_MakeEnvelope(5, 49, 6, 50, 4326)),
  ('FXX5,50', ST_MakeEnvelope(5, 50, 6, 51, 4326)),
  ('FXX5,51', ST_MakeEnvelope(5, 51, 6, 52, 4326)),
  ('FXX6,41', ST_MakeEnvelope(6, 41, 7, 42, 4326)),
  ('FXX6,42', ST_MakeEnvelope(6, 42, 7, 43, 4326)),
  ('FXX6,43', ST_MakeEnvelope(6, 43, 7, 44, 4326)),
  ('FXX6,44', ST_MakeEnvelope(6, 44, 7, 45, 4326)),
  ('FXX6,45', ST_MakeEnvelope(6, 45, 7, 46, 4326)),
  ('FXX6,46', ST_MakeEnvelope(6, 46, 7, 47, 4326)),
  ('FXX6,47', ST_MakeEnvelope(6, 47, 7, 48, 4326)),
  ('FXX6,48', ST_MakeEnvelope(6, 48, 7, 49, 4326)),
  ('FXX6,49', ST_MakeEnvelope(6, 49, 7, 50, 4326)),
  ('FXX6,50', ST_MakeEnvelope(6, 50, 7, 51, 4326)),
  ('FXX6,51', ST_MakeEnvelope(6, 51, 7, 52, 4326)),
  ('FXX7,41', ST_MakeEnvelope(7, 41, 8, 42, 4326)),
  ('FXX7,42', ST_MakeEnvelope(7, 42, 8, 43, 4326)),
  ('FXX7,43', ST_MakeEnvelope(7, 43, 8, 44, 4326)),
  ('FXX7,44', ST_MakeEnvelope(7, 44, 8, 45, 4326)),
  ('FXX7,45', ST_MakeEnvelope(7, 45, 8, 46, 4326)),
  ('FXX7,46', ST_MakeEnvelope(7, 46, 8, 47, 4326)),
  ('FXX7,47', ST_MakeEnvelope(7, 47, 8, 48, 4326)),
  ('FXX7,48', ST_MakeEnvelope(7, 48, 8, 49, 4326)),
  ('FXX7,49', ST_MakeEnvelope(7, 49, 8, 50, 4326)),
  ('FXX7,50', ST_MakeEnvelope(7, 50, 8, 51, 4326)),
  ('FXX7,51', ST_MakeEnvelope(7, 51, 8, 52, 4326)),
  ('FXX8,41', ST_MakeEnvelope(8, 41, 9, 42, 4326)),
  ('FXX8,42', ST_MakeEnvelope(8, 42, 9, 43, 4326)),
  ('FXX8,43', ST_MakeEnvelope(8, 43, 9, 44, 4326)),
  ('FXX8,44', ST_MakeEnvelope(8, 44, 9, 45, 4326)),
  ('FXX8,45', ST_MakeEnvelope(8, 45, 9, 46, 4326)),
  ('FXX8,46', ST_MakeEnvelope(8, 46, 9, 47, 4326)),
  ('FXX8,47', ST_MakeEnvelope(8, 47, 9, 48, 4326)),
  ('FXX8,48', ST_MakeEnvelope(8, 48, 9, 49, 4326)),
  ('FXX8,49', ST_MakeEnvelope(8, 49, 9, 50, 4326)),
  ('FXX8,50', ST_MakeEnvelope(8, 50, 9, 51, 4326)),
  ('FXX8,51', ST_MakeEnvelope(8, 51, 9, 52, 4326)),
  ('FXX9,41', ST_MakeEnvelope(9, 41, 10, 42, 4326)),
  ('FXX9,42', ST_MakeEnvelope(9, 42, 10, 43, 4326)),
  ('FXX9,43', ST_MakeEnvelope(9, 43, 10, 44, 4326)),
  ('FXX9,44', ST_MakeEnvelope(9, 44, 10, 45, 4326)),
  ('FXX9,45', ST_MakeEnvelope(9, 45, 10, 46, 4326)),
  ('FXX9,46', ST_MakeEnvelope(9, 46, 10, 47, 4326)),
  ('FXX9,47', ST_MakeEnvelope(9, 47, 10, 48, 4326)),
  ('FXX9,48', ST_MakeEnvelope(9, 48, 10, 49, 4326)),
  ('FXX9,49', ST_MakeEnvelope(9, 49, 10, 50, 4326)),
  ('FXX9,50', ST_MakeEnvelope(9, 50, 10, 51, 4326)),
  ('FXX9,51', ST_MakeEnvelope(9, 51, 10, 52, 4326)),
  ('GLP', ST_MakeEnvelope(-62, 15.8, -61, 16.6, 4326)),
  ('MTQ', ST_MakeEnvelope(-61.3, 14.3, -60.8, 15, 4326)),
  ('GUF', ST_MakeEnvelope(-55, 2, -51, 6, 4326)),
  ('REU', ST_MakeEnvelope(55, -22, 56, -20, 4326)),
  ('MYT', ST_MakeEnvelope(44, -14, 46, -12, 4326));

drop table if exists exterior;
create table exterior as
  select num, iso3, ST_Difference(box, geom) as geom
  from univers, comunionfxx
  where iso3 like 'FXX%' and ST_Dimension(ST_Difference(box, geom))=2
union
  select num, iso3, ST_Difference(box, geom) as geom
  from univers, comunionpardept
  where iso3 not like 'FXX%' and dept='97';
comment on table exterior is 'Limite extérieure de chaque gde zone géo., cad la limite du territoire avec la mer ou l''étranger.';
