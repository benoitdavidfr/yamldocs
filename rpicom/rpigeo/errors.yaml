title: erreurs détectées lors du chargement AE2020COG dans PostGis
description: |
  Ces erreurs sont dues au prétraitement effectué de réduction du nbre de chiffres significatifs
ae2020topo:
  title: erreurs lors du load.php ae2020topo (partiel)
  COMS59160:
    type: Feature
    id: '59160'
    properties:
      NOM_COM: Crespin
      NOM_COM_M: CRESPIN
      STATUT: 'Commune simple'
      INSEE_CAN: '29'
      INSEE_ARR: '6'
      INSEE_DEP: '59'
      INSEE_REG: '32'
      CODE_EPCI: '245901160'
      POPULATION: 4532
      TYPE: COM
    bbox:
      - 3.62769
      - 50.40138
      - 3.67367
      - 50.44085
    geometry:
      type: Polygon
      coordinates:
        - [[3.64945, 50.40184], [3.65352, 50.4027], [3.65471, 50.40279], [3.65383, 50.40147], [3.65448, 50.40138], [3.65782, 50.40284], [3.65874, 50.40304], [3.66042, 50.40375], [3.66075, 50.40326], [3.66095, 50.40313], [3.6614, 50.40314], [3.66212, 50.40343], [3.66261, 50.40334], [3.66294, 50.40314], [3.66285, 50.4027], [3.66421, 50.40307], [3.66455, 50.40331], [3.66499, 50.40346], [3.66621, 50.40339], [3.66616, 50.40354], [3.66798, 50.40342], [3.66802, 50.40321], [3.67014, 50.40293], [3.67219, 50.40324], [3.67135, 50.4044], [3.67117, 50.40519], [3.67053, 50.40606], [3.67032, 50.40654], [3.67037, 50.40684], [3.6699, 50.40852], [3.66969, 50.40866], [3.67063, 50.4089], [3.67072, 50.40886], [3.67285, 50.40949], [3.67367, 50.40967], [3.67338, 50.41089], [3.67321, 50.41101], [3.67297, 50.41098], [3.67291, 50.41104], [3.67291, 50.41132], [3.67305, 50.41158], [3.67248, 50.41178], [3.67255, 50.4122], [3.67182, 50.41325], [3.67172, 50.4136], [3.67142, 50.41392], [3.67144, 50.41398], [3.6718, 50.41394], [3.67192, 50.41399], [3.67195, 50.41418], [3.67223, 50.41436], [3.67231, 50.41454], [3.67184, 50.41471], [3.67124, 50.41512], [3.67127, 50.41529], [3.67172, 50.41559], [3.67131, 50.41603], [3.67044, 50.41646], [3.67012, 50.41775], [3.67038, 50.41814], [3.67045, 50.41846], [3.67049, 50.41934], [3.67023, 50.41932], [3.67028, 50.41977], [3.67252, 50.42023], [3.67226, 50.42224], [3.67065, 50.42262], [3.66907, 50.42283], [3.66899, 50.42294], [3.66894, 50.42406], [3.66921, 50.42517], [3.66906, 50.42707], [3.6693, 50.42758], [3.66965, 50.42898], [3.66952, 50.43017], [3.66906, 50.43094], [3.66886, 50.43394], [3.66906, 50.43536], [3.66886, 50.43686], [3.66981, 50.43726], [3.66694, 50.43604], [3.66595, 50.43577], [3.66579, 50.43675], [3.66533, 50.43742], [3.66511, 50.43736], [3.66442, 50.4365], [3.66163, 50.43625], [3.6616, 50.43703], [3.65989, 50.43693], [3.6576, 50.43668], [3.65689, 50.43756], [3.65418, 50.44039], [3.65278, 50.43975], [3.65268, 50.43975], [3.65206, 50.44027], [3.65089, 50.43998], [3.64905, 50.43939], [3.6482, 50.43925], [3.6481, 50.43914], [3.64814, 50.43899], [3.64628, 50.43781], [3.64477, 50.43854], [3.64376, 50.43926], [3.64341, 50.43938], [3.64353, 50.43964], [3.64208, 50.44085], [3.6417, 50.44062], [3.64152, 50.44026], [3.64098, 50.44001], [3.64085, 50.43975], [3.63999, 50.43955], [3.63953, 50.43932], [3.63908, 50.43932], [3.63841, 50.43872], [3.63783, 50.43846], [3.63757, 50.4382], [3.63625, 50.43854], [3.63533, 50.43859], [3.63464, 50.43904], [3.63294, 50.43755], [3.63218, 50.43723], [3.63099, 50.43724], [3.63089, 50.43717], [3.63097, 50.43713], [3.63104, 50.43584], [3.63113, 50.43574], [3.63145, 50.43121], [3.63132, 50.43115], [3.63128, 50.43077], [3.63049, 50.43004], [3.63043, 50.4298], [3.63136, 50.42595], [3.62971, 50.42612], [3.62958, 50.42643], [3.62809, 50.4267], [3.62794, 50.42634], [3.62822, 50.42617], [3.62792, 50.42574], [3.62769, 50.42564], [3.62807, 50.42555], [3.62846, 50.42533], [3.62919, 50.42395], [3.62994, 50.42341], [3.63031, 50.42252], [3.63077, 50.42243], [3.63097, 50.42228], [3.63071, 50.42097], [3.63057, 50.42099], [3.63027, 50.42076], [3.63049, 50.42045], [3.63024, 50.42016], [3.62965, 50.41991], [3.62999, 50.41961], [3.62943, 50.41906], [3.63011, 50.41845], [3.62907, 50.41797], [3.62986, 50.41736], [3.63068, 50.41744], [3.6318, 50.41785], [3.63245, 50.41727], [3.63224, 50.41709], [3.63234, 50.41691], [3.6326, 50.41677], [3.63298, 50.41679], [3.63338, 50.41702], [3.6338, 50.41691], [3.63412, 50.41716], [3.63463, 50.41731], [3.6348, 50.41718], [3.63388, 50.41659], [3.63355, 50.41598], [3.63066, 50.41554], [3.63072, 50.41455], [3.6311, 50.41425], [3.63186, 50.41397], [3.63218, 50.41392], [3.63341, 50.41441], [3.63392, 50.41445], [3.63499, 50.41471], [3.63575, 50.41473], [3.63634, 50.41458], [3.63743, 50.41348], [3.63745, 50.41326], [3.63773, 50.41299], [3.63781, 50.41269], [3.63822, 50.41223], [3.63857, 50.41228], [3.63979, 50.41204], [3.64059, 50.41181], [3.64116, 50.41151], [3.64202, 50.41087], [3.64356, 50.40922], [3.64453, 50.40803], [3.6447, 50.408], [3.64781, 50.40432], [3.64803, 50.40381], [3.64944, 50.40243], [3.64945, 50.40184]]
    ftell: 97373173
    select topology.TopoGeo_AddPolygon('aegeofla_topo', ST_GeomFromText('POLYGON((3.64945 50.40184,3.65352 50.4027,3.65471 50.40279,3.65383 50.40147,3.65448 50.40138,3.65782 50.40284,3.65874 50.40304,3.66042 50.40375,3.66075 50.40326,3.66095 50.40313,3.6614 50.40314,3.66212 50.40343,3.66261 50.40334,3.66294 50.40314,3.66285 50.4027,3.66421 50.40307,3.66455 50.40331,3.66499 50.40346,3.66621 50.40339,3.66616 50.40354,3.66798 50.40342,3.66802 50.40321,3.67014 50.40293,3.67219 50.40324,3.67135 50.4044,3.67117 50.40519,3.67053 50.40606,3.67032 50.40654,3.67037 50.40684,3.6699 50.40852,3.66969 50.40866,3.67063 50.4089,3.67072 50.40886,3.67285 50.40949,3.67367 50.40967,3.67338 50.41089,3.67321 50.41101,3.67297 50.41098,3.67291 50.41104,3.67291 50.41132,3.67305 50.41158,3.67248 50.41178,3.67255 50.4122,3.67182 50.41325,3.67172 50.4136,3.67142 50.41392,3.67144 50.41398,3.6718 50.41394,3.67192 50.41399,3.67195 50.41418,3.67223 50.41436,3.67231 50.41454,3.67184 50.41471,3.67124 50.41512,3.67127 50.41529,3.67172 50.41559,3.67131 50.41603,3.67044 50.41646,3.67012 50.41775,3.67038 50.41814,3.67045 50.41846,3.67049 50.41934,3.67023 50.41932,3.67028 50.41977,3.67252 50.42023,3.67226 50.42224,3.67065 50.42262,3.66907 50.42283,3.66899 50.42294,3.66894 50.42406,3.66921 50.42517,3.66906 50.42707,3.6693 50.42758,3.66965 50.42898,3.66952 50.43017,3.66906 50.43094,3.66886 50.43394,3.66906 50.43536,3.66886 50.43686,3.66981 50.43726,3.66694 50.43604,3.66595 50.43577,3.66579 50.43675,3.66533 50.43742,3.66511 50.43736,3.66442 50.4365,3.66163 50.43625,3.6616 50.43703,3.65989 50.43693,3.6576 50.43668,3.65689 50.43756,3.65418 50.44039,3.65278 50.43975,3.65268 50.43975,3.65206 50.44027,3.65089 50.43998,3.64905 50.43939,3.6482 50.43925,3.6481 50.43914,3.64814 50.43899,3.64628 50.43781,3.64477 50.43854,3.64376 50.43926,3.64341 50.43938,3.64353 50.43964,3.64208 50.44085,3.6417 50.44062,3.64152 50.44026,3.64098 50.44001,3.64085 50.43975,3.63999 50.43955,3.63953 50.43932,3.63908 50.43932,3.63841 50.43872,3.63783 50.43846,3.63757 50.4382,3.63625 50.43854,3.63533 50.43859,3.63464 50.43904,3.63294 50.43755,3.63218 50.43723,3.63099 50.43724,3.63089 50.43717,3.63097 50.43713,3.63104 50.43584,3.63113 50.43574,3.63145 50.43121,3.63132 50.43115,3.63128 50.43077,3.63049 50.43004,3.63043 50.4298,3.63136 50.42595,3.62971 50.42612,3.62958 50.42643,3.62809 50.4267,3.62794 50.42634,3.62822 50.42617,3.62792 50.42574,3.62769 50.42564,3.62807 50.42555,3.62846 50.42533,3.62919 50.42395,3.62994 50.42341,3.63031 50.42252,3.63077 50.42243,3.63097 50.42228,3.63071 50.42097,3.63057 50.42099,3.63027 50.42076,3.63049 50.42045,3.63024 50.42016,3.62965 50.41991,3.62999 50.41961,3.62943 50.41906,3.63011 50.41845,3.62907 50.41797,3.62986 50.41736,3.63068 50.41744,3.6318 50.41785,3.63245 50.41727,3.63224 50.41709,3.63234 50.41691,3.6326 50.41677,3.63298 50.41679,3.63338 50.41702,3.6338 50.41691,3.63412 50.41716,3.63463 50.41731,3.6348 50.41718,3.63388 50.41659,3.63355 50.41598,3.63066 50.41554,3.63072 50.41455,3.6311 50.41425,3.63186 50.41397,3.63218 50.41392,3.63341 50.41441,3.63392 50.41445,3.63499 50.41471,3.63575 50.41473,3.63634 50.41458,3.63743 50.41348,3.63745 50.41326,3.63773 50.41299,3.63781 50.41269,3.63822 50.41223,3.63857 50.41228,3.63979 50.41204,3.64059 50.41181,3.64116 50.41151,3.64202 50.41087,3.64356 50.40922,3.64453 50.40803,3.6447 50.408,3.64781 50.40432,3.64803 50.40381,3.64944 50.40243,3.64945 50.40184))',4326), 0.00001)
    Exception Query failed: ERROR:  SQL/MM Spatial exception - curve not simple
    
ae2020:
  title: erreur de chargement dans php load.php ae2020
  COMS2A041:
    type: Feature
    id: 2A041
    properties:
      NOM_COM: Bonifacio
      NOM_COM_M: BONIFACIO
      STATUT: 'Commune simple'
      INSEE_CAN: '07'
      INSEE_ARR: '4'
      INSEE_DEP: 2A
      INSEE_REG: '94'
      CODE_EPCI: '200040764'
      POPULATION: 3118
      TYPE: COM
    bbox:
      - 9.08818
      - 41.36456
      - 9.28729
      - 41.50978
    geometry:
      type: Polygon
      coordinates:
        - [[9.09537, 41.44961], [9.09544, 41.44944], [9.09515, 41.44926], [9.09522, 41.44914], [9.09516, 41.44911], ...
    update public.eadminv
    set topo = topology.toTopoGeom(ST_GeomFromText('POLYGON((9.09537 41.44961,9.09544 41.44944,9.09515 41.44926,9.09522 41.44914, ...
    9778 41.45169,9.09712 41.45119,9.09623 41.45083,9.09587 41.45056,9.09578 41.44989,9.09537 41.44961))',4326), 'aegeofla_topo', 1),
        bbox = ST_SetSRID(ST_MakeBox2D(ST_Point(9.088180,41.364560),ST_Point(9.287290,41.509780)), 4326)
    where cinsee='2A041' and fin is null
    Exception Query failed: ERROR:  Invalid edge (no two distinct vertices exist)
    CONTEXT:  PL/pgSQL function topology.totopogeom(geometry,topology.topogeometry,double precision) line 112 at FOR over SELECT rows
    PL/pgSQL function topology.totopogeom(geometry,character varying,integer,double precision) line 88 at assignment
  
  COMS59160:
    Feature:
      type: Feature
      id: '59160'
      properties:
        NOM_COM: Crespin
        NOM_COM_M: CRESPIN
        STATUT: 'Commune simple'
        INSEE_CAN: '29'
        INSEE_ARR: '6'
        INSEE_DEP: '59'
        INSEE_REG: '32'
        CODE_EPCI: '245901160'
        POPULATION: 4532
        TYPE: COM
      bbox: [3.62769, 50.40138, 3.67367, 50.44085]
      geometry:
        type: Polygon
        coordinates:
          - [[3.64945, 50.40184], [3.65352, 50.4027], [3.65471, 50.40279], [3.65383, 50.40147], [3.65448, 50.40138], ...
    sql: |
      update public.eadminv
      set topo = topology.toTopoGeom(ST_GeomFromText('POLYGON((3.64945 50.40184,3.65352 50.4027,3.65471 50.40279,3.65383  ...
      3.6447 50.408,3.64781 50.40432,3.64803 50.40381,3.64944 50.40243,3.64945 50.40184))',4326), 'aegeofla_topo', 1),
          bbox = ST_SetSRID(ST_MakeBox2D(ST_Point(3.627690,50.401380),ST_Point(3.673670,50.440850)), 4326)
      where cinsee='59160' and fin is null
    error: |
      Exception Query failed: ERROR:  SQL/MM Spatial exception - curve not simple
      CONTEXT:  PL/pgSQL function topology.totopogeom(geometry,topology.topogeometry,double precision) line 112 at FOR over SELECT rows
      PL/pgSQL function topology.totopogeom(geometry,character varying,integer,double precision) line 88 at assignment
  COMS80713:
    type: Feature
    id: '80713'
    properties:
      NOM_COM: Saint-Quentin-en-Tourmont
      NOM_COM_M: 'SAINT QUENTIN EN TOURMONT'
      STATUT: 'Commune simple'
      INSEE_CAN: '23'
      INSEE_ARR: '1'
      INSEE_DEP: '80'
      INSEE_REG: '32'
      CODE_EPCI: '200070936'
      POPULATION: 282
      TYPE: COM
    bbox:
      - 1.53828
      - 50.25483
      - 1.62706
      - 50.30572
    geometry:
      type: Polygon
      coordinates:
        - [[1.61704, 50.28491], [1.61618, 50.28511], [1.61568, 50.28504], [1.61488, 50.28416], [1.61332, 50.28364], [1.61226, 50.28256], [1.
    update public.eadminv
    set topo = topology.toTopoGeom(ST_GeomFromText('POLYGON((1.61704 50.28491,1.61618 50.28511,1.61568 50.28504,1.61488 50.28416,...
    50.28221,1.61964 50.28291,1.61816 50.28345,1.61814 50.28378,1.61795 50.28413,1.61704 50.28491))',4326), 'aegeofla_topo', 1),
        bbox = ST_SetSRID(ST_MakeBox2D(ST_Point(1.538280,50.254830),ST_Point(1.627060,50.305720)), 4326)
    where cinsee='80713' and fin is null
    Exception Query failed: ERROR:  SQL/MM Spatial exception - curve not simple
    CONTEXT:  PL/pgSQL function topology.totopogeom(geometry,topology.topogeometry,double precision) line 112 at FOR over SELECT rows
    PL/pgSQL function topology.totopogeom(geometry,character varying,integer,double precision) line 88 at assignment
  
  COMS22093:
    type: Feature
    id: '22093'
    properties:
      NOM_COM: Lamballe-Armor
      NOM_COM_M: 'LAMBALLE ARMOR'
      STATUT: 'Commune simple'
      INSEE_CAN: '89'
      INSEE_ARR: '4'
      INSEE_DEP: '22'
      INSEE_REG: '53'
      CODE_EPCI: '200069391'
      POPULATION: 16578
      TYPE: COM
    bbox: [ -2.63412, 48.39602, -2.40612, 48.57584]
    geometry:
      type: Polygon
      coordinates:
        - [[-2.5752, 48.57584], [-2.57521, 48.57539], [-2.57536, 48.5751], [-2.57565, 48.57508], [-2.57594, 48.57494], ...
    update public.eadminv
    set topo = topology.toTopoGeom(ST_GeomFromText('POLYGON((-2.5752 48.57584,-2.57521 48.57539,-2.57536 48.5751,...
    -2.57304 48.57436,-2.57354 48.575,-2.57399 48.57539,-2.5752 48.57584))',4326), 'aegeofla_topo', 1),
        bbox = ST_SetSRID(ST_MakeBox2D(ST_Point(-2.634120,48.396020),ST_Point(-2.406120,48.575840)), 4326)
    where cinsee='22093' and fin is null
    Exception Query failed: ERROR:  SQL/MM Spatial exception - curve not simple
    CONTEXT:  PL/pgSQL function topology.totopogeom(geometry,topology.topogeometry,double precision) line 112 at FOR over SELECT rows
    PL/pgSQL function topology.totopogeom(geometry,character varying,integer,double precision) line 88 at assignment
  
  COMS97408:
    type: Feature
    id: '97408'
    properties:
      NOM_COM: 'La Possession'
      NOM_COM_M: POSSESSION
      STATUT: 'Commune simple'
      INSEE_CAN: '03'
      INSEE_ARR: '4'
      INSEE_DEP: '974'
      INSEE_REG: '04'
      CODE_EPCI: '249740101'
      POPULATION: 33020
      TYPE: COM
    bbox:
      - 55.31886
      - -21.09728
      - 55.46479
      - -20.89611
    geometry:
      type: Polygon
      coordinates:
        - [[55.46479, -21.08566], [55.46452, -21.08547], [55.46406, -21.08493], [55.46347, -21.08345], [55.46344, -21.08309], ...
    update public.eadminv
    set topo = topology.toTopoGeom(ST_GeomFromText('POLYGON((55.46479 -21.08566,55.46452 -21.08547,55.46406 -21.08493,...
    08637,55.46079 -21.08619,55.46224 -21.08604,55.46394 -21.08574,55.46479 -21.08566))',4326), 'aegeofla_topo', 1),
        bbox = ST_SetSRID(ST_MakeBox2D(ST_Point(55.318860,-21.097280),ST_Point(55.464790,-20.896110)), 4326)
    where cinsee='97408' and fin is null
    Exception Query failed: ERROR:  Invalid edge (no two distinct vertices exist)
    CONTEXT:  PL/pgSQL function topology.totopogeom(geometry,topology.topogeometry,double precision) line 112 at FOR over SELECT rows
    PL/pgSQL function topology.totopogeom(geometry,character varying,integer,double precision) line 88 at assignment
  
  COMD22173:
    type: Feature
    id: '22173'
    properties:
      NOM_COM: Planguenoual
      NOM_COM_M: PLANGUENOUAL
      INSEE_RATT: '22093'
      TYPE: COMD
      POPULATION: 2195
    bbox: [-2.62845, 48.5009, -2.50805, 48.57584]
    geometry:
      type: Polygon
      coordinates:
        - [[-2.58884, 48.50587], [-2.58777, 48.50583], [-2.58737, 48.50593], [-2.58682, 48.50624], [-2.58662, 48.50653], ...
    update public.eadminv
    set topo = topology.toTopoGeom(ST_GeomFromText('POLYGON((-2.58884 48.50587,-2.58777 48.50583,-2.58737 48.50593,-2.58682 48.50624,...
    where cinsee='22173' and fin is null and statut<>'cSimple'
    Exception Query failed: ERROR:  SQL/MM Spatial exception - curve not simple
    CONTEXT:  PL/pgSQL function topology.totopogeom(geometry,topology.topogeometry,double precision) line 112 at FOR over SELECT rows
    PL/pgSQL function topology.totopogeom(geometry,character varying,integer,double precision) line 88 at assignment
eof:
