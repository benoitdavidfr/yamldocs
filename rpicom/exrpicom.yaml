title: définition du schéma du référentiel pivot des codes INSEE des communes avec illustration
modified: '2020-04-21'
description: |
  Le champ $schema contient le schéma du Rpicom.
  Le champ contents fournit des exemples illustratifs d'éléments de ce référentiel pour faciliter la compréhension du schéma.
$schema:
  title: schéma du référentiel pivot des codes INSEE des communes
  $id: http://id.georef.eu/mvtscommunes/exrpicom/$schema
  $schema: http://json-schema.org/draft-07/schema#
  description: Les codes INSEE de commune ayant existé avec infos versionnées associées en ordre chrono inverse
  definitions:
    commeDéléguée:
      description: si la c. est déléguée d'elle même alors cette partie définit les prop. de la c. déléguée
      type: object
      required: [name]
      properties:
        name:
          description: nom de la commune déléguée portant ce code INSEE
          type: string
        geo:
          description: point utilisant le schéma de codage http://dublincore.org/documents/dcmi-point/
          $ref: http://id.georef.eu/dcmi#Point
        spatial:
          description: emprise spatiale utilisant le sch. de codage http://dublincore.org/documents/dcmi-box/
          $ref: http://id.georef.eu/dcmi#Box
    sansSesAssociées:
      description: si la c. a des c. associées alors cette partie définit les prop. de la c. sans ses c. associées
      type: object
      properties:
        geo:
          description: point utilisant le schéma de codage http://dublincore.org/documents/dcmi-point/
          $ref: http://id.georef.eu/dcmi#Point
        spatial:
          description: emprise spatiale utilisant le sch. de codage http://dublincore.org/documents/dcmi-box/
          $ref: http://id.georef.eu/dcmi#Box
    rpicom:
      description: |
        Dictionnaire associant à chaque code INSEE les différentes versions identifiées par une date
        ou par le mot-clé 'now' identifiant la dernière version connue.
      type: object
      additionalProperties: false
      patternProperties:
        '^\d[\dAB]\d\d\d$': # code INSEE
          description: |
            Le mot-clé 'now' identifie la dernière version connue avec les dernières propriétés valides.
            Une date identifie une version historique qui peut être:
              - soit une action d'évolution ou de disparition à la date de la version
                plus un ensemble de propriétés périmées qui ont été valides avant la date de la version
              - soit une action d'apparition de l'entité à la date de la version
          type: object
          additionalProperties: false
          patternProperties:
            '^now$':
              description: propriétés de la dernière version connue
              type: object
              required: [name]
              additionalProperties: false
              properties:
                name:
                  description: dernier nom connu
                  type: string
                geo:
                  description: point utilisant le schéma de codage http://dublincore.org/documents/dcmi-point/
                  $ref: http://id.georef.eu/dcmi#/definitions/Point
                spatial:
                  description: emprise spatiale utilisant le schéma de codage http://dublincore.org/documents/dcmi-box/
                  $ref: http://id.georef.eu/dcmi#/definitions/Box
                estAssociéeA:
                  description: si c. associée alors id de la commune de rattachement
                  type: [string, number]
                  pattern: '^\d[\dAB]\d\d\d$'
                estDéléguéeDe:
                  description: si c. déléguée alors id de la commune de rattachement
                  type: [string, number]
                  pattern: '^\d[\dAB]\d\d\d$'
                estArrondissementMunicipalDe:
                  description: si arrondissement municipal alors id de la commune de rattachement
                  type: [string, number]
                  pattern: '^\d[\dAB]\d\d\d$'
                commeDéléguée:
                  description: si c. déléguée d'elle même alors cette partie définit les prop. de la c. déléguée
                  $ref: '#/definitions/commeDéléguée'
                sansSesAssociées:
                  description: si la c. a des c. associées alors cette partie définit les prop. de la c. sans ses associées
                  $ref: '#/definitions/sansSesAssociées'
            '^\d\d\d\d-\d\d-\d\d$': # date
              description: version historique datée
              oneOf:
                - description: action d'évolution ou de disparition à cette date plus propriétés périmées après cette date 
                  type: object
                  required: [name]
                  additionalProperties: false
                  properties:
                    name:
                      description: nom valide jusqu'à la date de la version
                      type: string
                    geo:
                      description: point utilisant le schéma de codage http://dublincore.org/documents/dcmi-point/
                      $ref: http://id.georef.eu/dcmi#/definitions/Point
                    spatial:
                      description: emprise spatiale utilisant le schéma de codage http://dublincore.org/documents/dcmi-box/
                      $ref: http://id.georef.eu/dcmi#/definitions/Box
                    estAssociéeA:
                      description: si c. associée alors id de la commune de rattachement
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    estDéléguéeDe:
                      description: si c'est c. déléguée alors id de la commune de rattachement
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    estArrondissementMunicipalDe:
                      description: si arrondissement municipal alors id de la commune de rattachement
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    commeDéléguée:
                      description: si c. déléguée d'elle même alors cette partie définit les prop. de la c. déléguée
                      $ref: '#/definitions/commeDéléguée'
                    sansSesAssociées:
                      description: si la c. a des associées alors cette partie définit les prop. de la c. sans elles
                      $ref: '#/definitions/sansSesAssociées'
                    # évènements d'évolution ou de disparition
                    évènement:
                      description: description de l'évènement ayant conduit au changement de version
                      enum:
                        - Change de nom
                        - Prend des c. associées et/ou absorbe des c. fusionnées
                        - Devient commune nouvelle
                        - Absorbe certaines de ses c. rattachées ou certaines de ses c. associées deviennent déléguées
                        - Commune rétablissant des c. rattachées ou fusionnées
                        - Commune associée rétablie comme commune simple
                        - Commune déléguée rétablie comme commune simple
                        - Commune rattachée devient commune de rattachement
                    seDissoutDans:
                      description: c. supprimée avec liste des id des c. dans lesquelles son territoire a été réparti
                      type: array
                      items:
                        type: [string, number]
                        format: '^\d[\dAB]\d\d\d$'
                    reçoitUnePartieDe:
                      description: c. recevant un territoire d'une commune supprimée avec l'id de la c. supprimée
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    contribueA:
                      description: c. contribuant à une c. créée avec l'id de la c. créée
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    absorbe:
                      description: >
                        c. absorbante dans une fusion simple ou c. nouv. sans c. dél. avec liste des id des c. absorbées
                      type: array
                      items:
                        type: [string, number]
                        format: '^\d[\dAB]\d\d\d$'
                    sAbsorbeDans:
                      description: >
                        c. absorbée dans une fusion simple ou une c. nouv. sans c. dél. avec id de la c. aborbante
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    sAssocieA:
                      description: c. s'associant par fusion-association à une commune de rattachement
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    fusionneDans:
                      description: c. fusionnant par fusion-association dans une commune de rattachement
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    resteAssociéeA:
                      description: c. restant associée à l'occasion d'une absorption
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    devientDéléguéeDe:
                      description: c. devenant déléguée à l'occasion de la création d'une c. nouvelle
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    resteDéléguéeDe:
                      description: c. restant déléguée à l'occasion d'une absorption
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    changedAssociéeEnDéléguéeDe:
                      description: c. associée devient déléguée 
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    changeDeDépartementEtPrendLeCode:
                      description: c. changeant d'id lors d'un changement de département avec nouvel id
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    perdRattachementPour:
                      description: c. de rattachement perdant son statut au profit de la c. dont l'id est indiqué
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    changeDeRattachementPour:
                      description: c. rattachée changeant de c. de rattachement au profit de la c. dont l'id est indiqué
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    après:
                      description: propriété temporaire pour vérifier la cohérence
                - description: action d'apparition à cette date
                  type: object
                  additionalProperties: false
                  properties:
                    évènement:
                      description: description de l'évènement ayant conduit l'apparition de l'entité
                      enum:
                        - Mayotte devient un DOM
                    rétablieCommeSimpleDe:
                      description: c. simple rétablie avec id de la c. dont elle est issue
                      type: [string, number]
                      pattern: '^\d[\dAB]\d\d\d$'
                    rétablieCommeAssociéeDe:
                      description: c. associée rétablie avec id de la c. dont elle est issue
                      type: [string, number]
                      pattern: '^\d[\dAB]\d\d\d$'
                    rétabliCommeArrondissementMunicipalDe:
                      description: arrondissement municipal rétabli avec id de celui dont il est issu
                      type: [string, number]
                      pattern: '^\d[\dAB]\d\d\d$'
                    crééeAPartirDe:
                      description: c. créée à cette date avec liste des id des communes dont provient son territoire
                      type: array
                      items:
                        type: [string, number]
                        pattern: '^\d[\dAB]\d\d\d$'
                    changeDeDépartementEtAvaitPourCode:
                      description: c. changeant de département avec précédent id
                      type: [string, number]
                      format: '^\d[\dAB]\d\d\d$'
                    crééeParFusionSimpleDe:
                      description: >
                        c. créée par fusion simple à l'occasion de laquelle un nouvel id est créé avec liste des id
                        des c. à partir desquelles cette fusion a été effectuée
                      type: array
                      items:
                        type: [string, number]
                        pattern: '^\d[\dAB]\d\d\d$'
                    après:
                      description: propriété temporaire pour vérifier la cohérence
  type: object
  properties:
    title:
      description: titre du document contenant le référentiel
      type: string
    created:
      description: date de création du document
      type: string
    modified:
      description: date de mise à jour du document
      type: string
    $schema:
      description: soit le schéma du document soit un lien vers ce schéma
      oneOf:
        - $ref: http://json-schema.org/draft-07/schema#
        - type: string
    ydADscrBhv:
      description: paramètres de comportement utilisés par le code Php de la classe AutoDescribed
      type: object
      additionalProperties: false
      properties:
        jsonLdContext:
          description: contexte JSON-LD à ajouter
          type: string
        firstLevelType:
          description: type des enregistrements de premier niveau dans contents
          type: string
        buildName:
          description: définition de l'affichage réduit par type d'objet, code Php par type défini dans definitions
          type: object
          additionalProperties:
            description: Pour chaque type le code Php d'affichage réduit est défini comme chaine
            type: string
        writePserReally:
          description: si défini alors le doc est stocké en pser
          type: boolean
    contents:
      description: contenu du référentiel comme dictionnaire associant à chaque code INSEE ses différentes versions
      $ref: '#/definitions/rpicom'
    eof:
      type: 'null'
ydADscrBhv:
  jsonLdContext: http://schema.org
  firstLevelType: AdministrativeArea
  buildName: # définition de l'affichage réduit par type d'objet, code Php par type
    AdministrativeArea: |
      if (isset($item['now']['name']))
        return $item['now']['name']." ($skey)";
      else
        return $skey;
contents:
  '01015':
    now:
      name: 'Arboys en Bugey'
      commeDéléguée:
        name: Arbignieu
    '2016-01-01':
      évènement: 'Devient commune nouvelle'
      name: Arbignieu
  '01340':
    now:
      name: Saint-Bois
      estDéléguéeDe: '01015'
    '2016-01-01':
      devientDéléguéeDe: '01015'
      name: Saint-Bois

  '01033':
    now:
      name: Valserhône
      commeDéléguée:
        name: Bellegarde-sur-Valserine
    '2019-01-01':
      évènement: 'Devient commune nouvelle'
      name: Bellegarde-sur-Valserine
    '1971-01-01':
      évènement: 'Prend des c. associées et/ou absorbe des c. fusionnées'
      name: Bellegarde-sur-Valserine
    '1966-03-23':
      évènement: 'Prend des c. associées et/ou absorbe des c. fusionnées'
      name: Bellegarde-sur-Valserine
    '1956-10-19':
      évènement: 'Change de nom'
      name: Bellegarde
  '01018':
    '1971-01-01':
      fusionneDans: '01033'
      name: Arlod
  '01091':
    now:
      name: Châtillon-en-Michaille
      estDéléguéeDe: '01033'
    '2019-01-01':
      devientDéléguéeDe: '01033'
      name: Châtillon-en-Michaille
    '1985-02-01':
      après:
        name: Châtillon-en-Michaille
      évènement: 'Absorbe certaines de ses c. rattachées ou certaines de ses c. associées deviennent déléguées'
      name: Châtillon-en-Michaille
    '1973-11-01':
      évènement: 'Prend des c. associées et/ou absorbe des c. fusionnées'
      name: Châtillon-de-Michaille
  '01278':
    '1985-02-01':
      fusionneDans: '01091'
      name: Ochiaz
      estAssociéeA: '01091'
    '1973-11-01':
      sAssocieA: '01091'
      name: Ochiaz

  '02524':
    now:
      name: Mont-Saint-Père
    '1979-06-15':
      évènement: 'Change de nom'
      name: Charmont-sur-Marne
    '1978-01-01':
      évènement: 'Commune rétablissant des c. rattachées ou fusionnées'
      name: Charmont-sur-Marne
    '1974-10-01':
      évènement: 'Prend des c. associées et/ou absorbe des c. fusionnées'
      name: Mont-Saint-Père
  '02166':
    now:
      name: Chartèves
    '1978-01-01':
      évènement: 'Commune associée rétablie comme commune simple'
      name: Chartèves
      estAssociéeA: '02524'
    '1974-10-01':
      sAssocieA: '02524'
      name: Chartèves

  2A004:
    now:
      name: Ajaccio
    '1976-01-01':
      changeDeDépartementEtAvaitPourCode: 20004
  20004:
    '1976-01-01':
      changeDeDépartementEtPrendLeCode: 2A004
      name: Ajaccio

eof:
